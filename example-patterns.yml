name: Example API Keys and Tokens

patterns:
  - name: Generic API Key
    type: generic_api_key
    regex:
      version: 0.1
      pattern: |
        [a-zA-Z0-9]{32,64}
      start: |
        (?i)(?:api[_-]?key|apikey|access[_-]?token|auth[_-]?token)[_\s]*[=:]\s*['"]*
      end: |
        ['"]*(?:\s|$|[,\]}])
      additional_not_match:
        - ^(?i)(test|example|demo|sample|dummy|fake|placeholder|your[_-]?key|insert[_-]?key|replace[_-]?this)$
        - ^[0]{8,}$
        - ^[1]{8,}$
    test:
      data: 'api_key = "abc123def456ghi789jkl012mno345pqr567stu890"'
      start_offset: 11
      end_offset: -2
    comments:
      - "Matches generic API keys with 32-64 alphanumeric characters"
      - "Includes common variable names for API keys"
      - "Excludes common test/placeholder values"

  - name: JWT Token
    type: jwt_token
    regex:
      version: 0.1
      pattern: |
        eyJ[a-zA-Z0-9+/=]+\.eyJ[a-zA-Z0-9+/=]+\.[a-zA-Z0-9+/=_-]+
      start: |
        (?i)(?:jwt|token|bearer)[_\s]*[=:]\s*['"]*
      end: |
        ['"]*(?:\s|$|[,\]}])
    test:
      data: 'jwt_token = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c"'
      start_offset: 13
      end_offset: -2
    comments:
      - "Matches JSON Web Tokens (JWT)"
      - "Standard JWT format with three base64-encoded sections"

  - name: Database Connection String
    type: database_connection
    regex:
      version: 0.1
      pattern: |
        [a-zA-Z0-9+/=_.-]{20,}
      start: |
        (?i)(?:database[_-]?url|connection[_-]?string|db[_-]?url)[_\s]*[=:]\s*['"]*(?:mongodb|mysql|postgresql|postgres)://[^:]+:[^@]+@
      end: |
        ['"]*(?:\s|$|[,\]}])
      additional_match:
        - "[@:/]"
    test:
      data: 'DATABASE_URL = "postgresql://user:secretpassword123@localhost:5432/mydb"'
      start_offset: 32
      end_offset: 48
    comments:
      - "Matches database connection strings with embedded credentials"
      - "Supports MongoDB, MySQL, and PostgreSQL formats"
